[
  {
    "text": "Dzi\u0119kuj\u0119 za wiadomo\u015B\u0107! Skontaktuj\u0119 si\u0119 z Tob\u0105 wkr\u00F3tce.",
    "firstAdded": "2025-10-12T15:32:00.9954036",
    "lastUsed": "2025-10-12T15:42:17.6216947",
    "uses": 3,
    "pinned": true
  },
  {
    "text": "\r\n            foreach (DataRow r in _historyTable.Ro",
    "firstAdded": "2025-10-12T15:45:31.3562538",
    "lastUsed": "2025-10-12T15:45:31.3562538",
    "uses": 1,
    "pinned": false
  },
  {
    "text": "                    Uses = Math.Max(1, r.Fiews)\r\n",
    "firstAdded": "2025-10-12T15:45:29.3671402",
    "lastUsed": "2025-10-12T15:45:29.3671402",
    "uses": 1,
    "pinned": false
  },
  {
    "text": "/***************************************\n***************************************/",
    "firstAdded": "2025-10-12T15:45:10.4145748",
    "lastUsed": "2025-10-12T15:45:10.4145748",
    "uses": 1,
    "pinned": false
  },
  {
    "text": "using System;\r\nusing System.Collections.Generic;\r\nusing System.Data;              // DataTable, DataView\r\nusing System.Diagnostics;       // Process\r\nusing System.Drawing;           // SystemIcons\r\nusing System.IO;\r\nusing System.Linq;\r\nusing System.Runtime.InteropServices; // P/Invoke\r\nusing System.Text;\r\nusing System.Text.Json;\r\nusing System.Text.Json.Serialization;\r\nusing System.Threading.Tasks;   // Task, async/await\r\nusing System.Windows.Forms;\r\n\r\nnamespace SnippetMgr\r\n{\r\n    public partial class Form1 : Form\r\n    {\r\n        private const int MaxTabs = 9;\r\n        private const int StatusRightMaxLen = 100;\r\n\r\n        // ===== WinAPI / Hotkeys / Clipboard =====\r\n        private const int WM_HOTKEY         = 0x0312;\r\n        private const int WM_SYSKEYDOWN     = 0x0104;\r\n        private const int WM_SYSKEYUP       = 0x0105;\r\n        private const int WM_CLIPBOARDUPDATE= 0x031D;\r\n        private const int SW_RESTORE        = 9;\r\n\r\n        private const uint MOD_ALT = 0x0001;\r\n        private const uint MOD_CONTROL = 0x0002;\r\n        private const uint MOD_SHIFT = 0x0004;\r\n        private const uint MOD_WIN = 0x0008;\r\n\r\n        private const int ID_HOTKEY_PRIMARY   = 9000;  // Win\u002BY\r\n        private const int ID_HOTKEY_FALLBACK  = 9001;  // Ctrl\u002BAlt\u002BY\r\n        private const int ID_HOTKEY_HISTORY   = 9002;  // Win\u002B\u0060\r\n        private const int ID_HOTKEY_HISTORY_FB= 9003;  // Ctrl\u002BAlt\u002B\u0060\r\n\r\n        [DllImport(\u0022user32.dll\u0022)] private static extern bool RegisterHotKey(IntPtr hWnd, int id, uint fsModifiers, Keys vk);\r\n        [DllImport(\u0022user32.dll\u0022)] private static extern bool UnregisterHotKey(IntPtr hWnd, int id);\r\n        [DllImport(\u0022user32.dll\u0022)] private static extern bool SetForegroundWindow(IntPtr hWnd);\r\n        [DllImport(\u0022user32.dll\u0022)] private static extern bool ShowWindow(IntPtr hWnd, int nCmdShow);\r\n        [DllImport(\u0022user32.dll\u0022)] private static extern bool AddClipboardFormatListener(IntPtr hwnd);\r\n        [DllImport(\u0022user32.dll\u0022)] private static extern bool RemoveClipboardFormatListener(IntPtr hwnd);\r\n\r\n        private bool _primaryRegistered = false;\r\n        private bool _fallbackRegistered = false;\r\n        private bool _histRegistered = false;\r\n        private bool _histRegisteredFb = false;\r\n\r\n        // === Clipboard collection ===\r\n        private bool _suppressNextClipboardCapture = false;\r\n        private const int ClipboardMaxLen = 20000; // ogranicz bardzo d\u0142ugie bloki\r\n\r\n        // ===== Tray =====\r\n        private NotifyIcon? _tray;\r\n        private ContextMenuStrip? _trayMenu;\r\n\r\n        // ===== Pliki =====\r\n        private string TemplatesPath =\u003E Path.Combine(AppContext.BaseDirectory, \u0022Data\u0022, \u0022templates.json\u0022);\r\n        private string HistoryPath   =\u003E Path.Combine(AppContext.BaseDirectory, \u0022Data\u0022, \u0022copied_history.json\u0022);\r\n\r\n        // ===== Historia (tab \u002B grid \u002B tabela \u002B toolbar) =====\r\n        private TabPage? _historyPage;\r\n        private DataGridView? _historyGrid;\r\n        private DataTable? _historyTable;\r\n\r\n        // toolbar (tylko dla \u201EHistoria\u201D)\r\n        private ToolStrip? _histToolbar;\r\n        private ToolStripTextBox? _histSearch;\r\n        private CheckBox? _histOnlyPinned;\r\n        private NumericUpDown? _histMinUses;\r\n        private ComboBox? _histSort;\r\n\r\n        public Form1()\r\n        {\r\n            InitializeComponent();\r\n\r\n            try { statusStrip1.ShowItemToolTips = true; } catch { }\r\n\r\n            SetupTray();\r\n\r\n            this.Load \u002B= Form1_Load;\r\n\r\n            this.KeyPreview = true;\r\n            this.KeyDown \u002B= Form1_KeyDown;\r\n\r\n            textBox1.TextChanged \u002B= textBox1_TextChanged;\r\n            textBox1.KeyDown \u002B= textBox1_KeyDown;\r\n\r\n            tabControl1.SelectedIndexChanged \u002B= TabControl1_SelectedIndexChanged;\r\n\r\n            try { this.MainMenuStrip = this.menuStrip1; } catch { }\r\n\r\n            this.Shown \u002B= (s, e) =\u003E FocusSearch();\r\n            this.Activated \u002B= (s, e) =\u003E FocusSearch(false);\r\n        }\r\n\r\n        // ===== Helper: ustaw kursor w textBox1 =====\r\n        private void FocusSearch(bool selectAll = true)\r\n        {\r\n            try\r\n            {\r\n                if (textBox1.CanFocus)\r\n                {\r\n                    textBox1.Focus();\r\n                    if (selectAll) textBox1.SelectAll();\r\n                    else textBox1.Select(textBox1.TextLength, 0);\r\n                }\r\n                this.ActiveControl = textBox1;\r\n            }\r\n            catch { }\r\n        }\r\n\r\n        // ===== Rejestracja globalnych skr\u00F3t\u00F3w \u002B clipboard listener =====\r\n        protected override void OnHandleCreated(EventArgs e)\r\n        {\r\n            base.OnHandleCreated(e);\r\n            TryRegisterHotkeys();\r\n            try { AddClipboardFormatListener(this.Handle); } catch { }\r\n        }\r\n\r\n        protected override void OnHandleDestroyed(EventArgs e)\r\n        {\r\n            try { RemoveClipboardFormatListener(this.Handle); } catch { }\r\n            try { if (_primaryRegistered) UnregisterHotKey(this.Handle, ID_HOTKEY_PRIMARY); } catch { }\r\n            try { if (_fallbackRegistered) UnregisterHotKey(this.Handle, ID_HOTKEY_FALLBACK); } catch { }\r\n            try { if (_histRegistered) UnregisterHotKey(this.Handle, ID_HOTKEY_HISTORY); } catch { }\r\n            try { if (_histRegisteredFb) UnregisterHotKey(this.Handle, ID_HOTKEY_HISTORY_FB); } catch { }\r\n            base.OnHandleDestroyed(e);\r\n        }\r\n\r\n        private void TryRegisterHotkeys()\r\n        {\r\n            // Win\u002BY toggle\r\n            _primaryRegistered = RegisterHotKey(this.Handle, ID_HOTKEY_PRIMARY, MOD_WIN, Keys.Y);\r\n            if (!_primaryRegistered)\r\n            {\r\n                _fallbackRegistered = RegisterHotKey(this.Handle, ID_HOTKEY_FALLBACK, MOD_CONTROL | MOD_ALT, Keys.Y);\r\n                if (_fallbackRegistered)\r\n                {\r\n                    BeginInvoke(new Action(() =\u003E\r\n                        MessageBox.Show(this, \u0022Win\u002BY jest zaj\u0119ty przez system. U\u017Cyj Ctrl\u002BAlt\u002BY.\u0022,\r\n                            \u0022Skr\u00F3t alternatywny\u0022, MessageBoxButtons.OK, MessageBoxIcon.Information)\r\n                    ));\r\n                }\r\n                else\r\n                {\r\n                    BeginInvoke(new Action(() =\u003E\r\n                        MessageBox.Show(this, \u0022Nie uda\u0142o si\u0119 zarejestrowa\u0107 skr\u00F3t\u00F3w Win\u002BY ani Ctrl\u002BAlt\u002BY.\u0022,\r\n                            \u0022B\u0142\u0105d rejestracji\u0022, MessageBoxButtons.OK, MessageBoxIcon.Warning)\r\n                    ));\r\n                }\r\n            }\r\n\r\n            // Win\u002B\u0060\r\n            _histRegistered = RegisterHotKey(this.Handle, ID_HOTKEY_HISTORY, MOD_WIN, Keys.Oem3);\r\n            if (!_histRegistered)\r\n            {\r\n                _histRegisteredFb = RegisterHotKey(this.Handle, ID_HOTKEY_HISTORY_FB, MOD_CONTROL | MOD_ALT, Keys.Oem3);\r\n                if (_histRegisteredFb)\r\n                {\r\n                    BeginInvoke(new Action(() =\u003E\r\n                        MessageBox.Show(this, \u0022Win\u002B\u0060 jest zaj\u0119ty. U\u017Cyj Ctrl\u002BAlt\u002B\u0060 aby otworzy\u0107 Histori\u0119.\u0022,\r\n                            \u0022Skr\u00F3t alternatywny\u0022, MessageBoxButtons.OK, MessageBoxIcon.Information)\r\n                    ));\r\n                }\r\n                else\r\n                {\r\n                    BeginInvoke(new Action(() =\u003E\r\n                        MessageBox.Show(this, \u0022Nie uda\u0142o si\u0119 zarejestrowa\u0107 skr\u00F3t\u00F3w do Historii (Win\u002B\u0060 / Ctrl\u002BAlt\u002B\u0060).\u0022,\r\n                            \u0022B\u0142\u0105d rejestracji\u0022, MessageBoxButtons.OK, MessageBoxIcon.Warning)\r\n                    ));\r\n                }\r\n            }\r\n        }\r\n\r\n        // ========= ALT \u002B 1..9 =========\r\n        private void Form1_KeyDown(object? sender, KeyEventArgs e)\r\n        {\r\n            if (e.Alt \u0026\u0026 e.KeyCode \u003E= Keys.D1 \u0026\u0026 e.KeyCode \u003C= Keys.D9)\r\n            {\r\n                int index = e.KeyCode - Keys.D1;\r\n                if (index \u003C tabControl1.TabPages.Count)\r\n                {\r\n                    tabControl1.SelectedIndex = index;\r\n                    e.Handled = true;\r\n                    ApplyFilterToActiveTab(textBox1.Text);\r\n                    BeginInvoke(new Action(() =\u003E FocusSearch(false)));\r\n                }\r\n            }\r\n        }\r\n\r\n        // ===== Obs\u0142uga komunikat\u00F3w okna =====\r\n        protected override void WndProc(ref Message m)\r\n        {\r\n            // Globalne hotkeye\r\n            if (m.Msg == WM_HOTKEY)\r\n            {\r\n                int id = m.WParam.ToInt32();\r\n                if (id == ID_HOTKEY_PRIMARY || id == ID_HOTKEY_FALLBACK)\r\n                {\r\n                    ToggleWindow();\r\n                    return;\r\n                }\r\n                if (id == ID_HOTKEY_HISTORY || id == ID_HOTKEY_HISTORY_FB)\r\n                {\r\n                    ShowAndActivate();\r\n                    EnsureHistoryTabCreated();\r\n                    if (_historyPage != null)\r\n                    {\r\n                        tabControl1.SelectedTab = _historyPage;\r\n                        BeginInvoke(new Action(() =\u003E\r\n                        {\r\n                            _historyGrid?.Focus();\r\n                            if (_historyGrid != null \u0026\u0026 _historyGrid.Rows.Count \u003E 0)\r\n                            {\r\n                                _historyGrid.ClearSelection();\r\n                                _historyGrid.Rows[0].Selected = true;\r\n                            }\r\n                        }));\r\n                    }\r\n                    return;\r\n                }\r\n            }\r\n\r\n            // Nas\u0142uch schowka\r\n            if (m.Msg == WM_CLIPBOARDUPDATE)\r\n            {\r\n                TryCaptureClipboard();\r\n                base.WndProc(ref m);\r\n                return;\r\n            }\r\n\r\n            // Wy\u0142\u0105cz \u201EAlt otwiera menu\u201D\r\n            if ((m.Msg == WM_SYSKEYDOWN || m.Msg == WM_SYSKEYUP) \u0026\u0026 (Keys)m.WParam == Keys.Menu)\r\n            {\r\n                FocusSearch(false);\r\n                return;\r\n            }\r\n\r\n            base.WndProc(ref m);\r\n        }\r\n\r\n        // Zbieranie wszystkiego ze schowka (tekst)\r\n        private void TryCaptureClipboard()\r\n        {\r\n            try\r\n            {\r\n                if (_suppressNextClipboardCapture)\r\n                {\r\n                    _suppressNextClipboardCapture = false; // pomi\u0144 jednorazowo nasz w\u0142asny SetText\r\n                    return;\r\n                }\r\n\r\n                if (Clipboard.ContainsText())\r\n                {\r\n                    string txt = Clipboard.GetText() ?? string.Empty;\r\n                    if (string.IsNullOrWhiteSpace(txt)) return;\r\n                    if (txt.Length \u003E ClipboardMaxLen) txt = txt.Substring(0, ClipboardMaxLen);\r\n\r\n                    AddOrBumpHistory(txt, DateTime.Now, pinned: false, increaseUse: 1);\r\n                    SaveHistoryToDisk();\r\n                }\r\n            }\r\n            catch\r\n            {\r\n                // schowek mo\u017Ce by\u0107 chwilowo zaj\u0119ty przez inne procesy \u2013 pomijamy\r\n            }\r\n        }\r\n\r\n        private void ToggleWindow()\r\n        {\r\n            bool isActive = this.Visible \u0026\u0026\r\n                            this.WindowState != FormWindowState.Minimized \u0026\u0026\r\n                            Form.ActiveForm == this;\r\n\r\n            if (isActive) HideToTray(); else ShowAndActivate();\r\n        }\r\n\r\n        private void HideToTray()\r\n        {\r\n            this.Hide();\r\n            this.ShowInTaskbar = false;\r\n            if (this.WindowState != FormWindowState.Minimized)\r\n                this.WindowState = FormWindowState.Minimized;\r\n        }\r\n\r\n        private void ShowAndActivate()\r\n        {\r\n            if (!this.Visible) this.Show();\r\n            this.ShowInTaskbar = true;\r\n\r\n            if (this.WindowState == FormWindowState.Minimized)\r\n                this.WindowState = FormWindowState.Normal;\r\n\r\n            ShowWindow(this.Handle, SW_RESTORE);\r\n\r\n            bool wasTopMost = this.TopMost;\r\n            this.TopMost = true;\r\n            this.TopMost = wasTopMost;\r\n\r\n            SetForegroundWindow(this.Handle);\r\n            this.Activate();\r\n            this.BringToFront();\r\n            this.Focus();\r\n\r\n            FocusSearch(false);\r\n        }\r\n\r\n        // ===== Tray =====\r\n        private void SetupTray()\r\n        {\r\n            _trayMenu = new ContextMenuStrip();\r\n            _trayMenu.Items.Add(\u0022Poka\u017C okno\u0022, null, (_, __) =\u003E ShowAndActivate());\r\n            _trayMenu.Items.Add(\u0022Przejd\u017A do historii (Win\u002B\u0060)\u0022, null, (_, __) =\u003E\r\n            {\r\n                ShowAndActivate();\r\n                EnsureHistoryTabCreated();\r\n                if (_historyPage != null) tabControl1.SelectedTab = _historyPage;\r\n            });\r\n            _trayMenu.Items.Add(\u0022Ukryj\u0022, null, (_, __) =\u003E HideToTray());\r\n            _trayMenu.Items.Add(new ToolStripSeparator());\r\n            _trayMenu.Items.Add(\u0022Zako\u0144cz\u0022, null, (_, __) =\u003E Close());\r\n\r\n            _tray = new NotifyIcon\r\n            {\r\n                Icon = SystemIcons.Application,\r\n                Visible = true,\r\n                Text = \u0022SnippetMgr (Win\u002BY / Ctrl\u002BAlt\u002BY, Win\u002B\u0060 / Ctrl\u002BAlt\u002B\u0060)\u0022,\r\n                ContextMenuStrip = _trayMenu\r\n            };\r\n            _tray.DoubleClick \u002B= (_, __) =\u003E ShowAndActivate();\r\n        }\r\n\r\n        protected override void OnFormClosing(FormClosingEventArgs e)\r\n        {\r\n            try { if (_primaryRegistered) UnregisterHotKey(this.Handle, ID_HOTKEY_PRIMARY); } catch { }\r\n            try { if (_fallbackRegistered) UnregisterHotKey(this.Handle, ID_HOTKEY_FALLBACK); } catch { }\r\n            try { if (_histRegistered) UnregisterHotKey(this.Handle, ID_HOTKEY_HISTORY); } catch { }\r\n            try { if (_histRegisteredFb) UnregisterHotKey(this.Handle, ID_HOTKEY_HISTORY_FB); } catch { }\r\n            try { RemoveClipboardFormatListener(this.Handle); } catch { }\r\n\r\n            if (_tray != null) { _tray.Visible = false; _tray.Dispose(); }\r\n            _trayMenu?.Dispose();\r\n            base.OnFormClosing(e);\r\n        }\r\n\r\n        // ===== menu: Zarz\u0105dzaj\u2026 \u2014 PRZE\u0141ADUJ JSON =====\r\n        private void zarzadzajToolStripMenuItem_Click(object sender, EventArgs e)\r\n        {\r\n            try\r\n            {\r\n                EnsureDataDir();\r\n\r\n                if (!File.Exists(TemplatesPath))\r\n                    throw new FileNotFoundException($\u0022Nie znaleziono pliku: {TemplatesPath}\u0022);\r\n\r\n                string json = File.ReadAllText(TemplatesPath, Encoding.UTF8);\r\n                CreateTabsFromJson(json);\r\n                LoadHistoryFromDisk(); // opcjonalnie\r\n                ApplyFilterToActiveTab(textBox1.Text);\r\n                SetStatus(\u0022JSON wczytany\u0022, \u0022program dzia\u0142a\u0022);\r\n                FocusSearch();\r\n            }\r\n            catch (Exception ex)\r\n            {\r\n                MessageBox.Show($\u0022Nie uda\u0142o si\u0119 prze\u0142adowa\u0107 danych:\\n{ex.Message}\u0022, \u0022B\u0142\u0105d\u0022,\r\n                    MessageBoxButtons.OK, MessageBoxIcon.Error);\r\n            }\r\n        }\r\n\r\n        // ===== Startup =====\r\n        private void Form1_Load(object? sender, EventArgs e)\r\n        {\r\n            try\r\n            {\r\n                EnsureDataDir();\r\n\r\n                if (!File.Exists(TemplatesPath))\r\n                    throw new FileNotFoundException($\u0022Nie znaleziono pliku: {TemplatesPath}\u0022);\r\n\r\n                string json = File.ReadAllText(TemplatesPath, Encoding.UTF8);\r\n\r\n                CreateTabsFromJson(json);\r\n                LoadHistoryFromDisk();\r\n                ApplyFilterToActiveTab(textBox1.Text);\r\n\r\n                SetStatus(\u0022JSON wczytany\u0022, \u0022program dzia\u0142a\u0022);\r\n                FocusSearch();\r\n            }\r\n            catch (FileNotFoundException ex)\r\n            {\r\n                MessageBox.Show(ex.Message, \u0022B\u0142\u0105d \u2014 brak pliku\u0022, MessageBoxButtons.OK, MessageBoxIcon.Warning);\r\n                SetStatus(\u0022B\u0142\u0105d\u0022, \u0022Brak pliku JSON\u0022);\r\n                FocusSearch();\r\n            }\r\n            catch (JsonException ex)\r\n            {\r\n                MessageBox.Show($\u0022Plik JSON ma nieprawid\u0142owy format.\\n{ex.Message}\u0022, \u0022B\u0142\u0105d JSON\u0022, MessageBoxButtons.OK, MessageBoxIcon.Error);\r\n                SetStatus(\u0022B\u0142\u0105d\u0022, \u0022Niepoprawny JSON\u0022);\r\n                FocusSearch();\r\n            }\r\n            catch (Exception ex)\r\n            {\r\n                MessageBox.Show($\u0022Wyst\u0105pi\u0142 nieoczekiwany b\u0142\u0105d.\\n{ex.Message}\u0022, \u0022B\u0142\u0105d\u0022, MessageBoxButtons.OK, MessageBoxIcon.Error);\r\n                SetStatus(\u0022B\u0142\u0105d\u0022, \u0022Program dzia\u0142a z b\u0142\u0119dem\u0022);\r\n                FocusSearch();\r\n            }\r\n        }\r\n\r\n        private void EnsureDataDir()\r\n        {\r\n            string dir = Path.Combine(AppContext.BaseDirectory, \u0022Data\u0022);\r\n            if (!Directory.Exists(dir)) Directory.CreateDirectory(dir);\r\n        }\r\n\r\n        // ====== Tworzenie zak\u0142adek z templates.json ======\r\n        private void CreateTabsFromJson(string json)\r\n        {\r\n            using var doc = JsonDocument.Parse(json);\r\n            var root = doc.RootElement;\r\n\r\n            if (!root.TryGetProperty(\u0022tabs\u0022, out var tabs) || tabs.ValueKind != JsonValueKind.Array)\r\n                throw new JsonException(\u0022Plik JSON nie zawiera prawid\u0142owego pola \u0027tabs\u0027.\u0022);\r\n\r\n            tabControl1.TabPages.Clear();\r\n            // wyczy\u015B\u0107 referencje historii (utworzymy na nowo)\r\n            _historyPage = null; _historyGrid = null; _historyTable = null;\r\n            _histToolbar = null; _histSearch = null; _histOnlyPinned = null; _histMinUses = null; _histSort = null;\r\n\r\n            int totalTabs = tabs.GetArrayLength();\r\n            int addedCount = 0;\r\n\r\n            if (totalTabs \u003E MaxTabs)\r\n            {\r\n                MessageBox.Show(\r\n                    $\u0022Plik JSON zawiera {totalTabs} zak\u0142adek.\\n\u0022 \u002B\r\n                    $\u0022Maksymalnie mo\u017Cna utworzy\u0107 {MaxTabs} zak\u0142adek.\\n\u0022 \u002B\r\n                    $\u0022Zostan\u0105 wczytane tylko pierwsze {MaxTabs}.\u0022,\r\n                    \u0022Limit zak\u0142adek\u0022,\r\n                    MessageBoxButtons.OK,\r\n                    MessageBoxIcon.Warning\r\n                );\r\n            }\r\n\r\n            foreach (var tab in tabs.EnumerateArray())\r\n            {\r\n                if (addedCount \u003E= MaxTabs) break;\r\n                if (!tab.TryGetProperty(\u0022tab_name\u0022, out var nameEl) || nameEl.ValueKind != JsonValueKind.String)\r\n                    continue;\r\n\r\n                string name = nameEl.GetString() ?? \u0022Bez nazwy\u0022;\r\n                var page = new TabPage($\u0022{addedCount \u002B 1}. {name}\u0022);\r\n\r\n                var grid = new DataGridView\r\n                {\r\n                    Dock = DockStyle.Fill,\r\n                    ReadOnly = true,\r\n                    AllowUserToAddRows = false,\r\n                    AllowUserToDeleteRows = false,\r\n                    AllowUserToOrderColumns = true,\r\n                    SelectionMode = DataGridViewSelectionMode.FullRowSelect,\r\n                    AutoSizeColumnsMode = DataGridViewAutoSizeColumnsMode.Fill,\r\n                    MultiSelect = false\r\n                };\r\n\r\n                var table = new DataTable { CaseSensitive = false };\r\n                table.Columns.Add(\u0022Shortcut\u0022, typeof(string));\r\n                table.Columns.Add(\u0022Description\u0022, typeof(string));\r\n                table.Columns.Add(\u0022Text\u0022, typeof(string));\r\n\r\n                if (tab.TryGetProperty(\u0022entries\u0022, out var entriesEl) \u0026\u0026 entriesEl.ValueKind == JsonValueKind.Array)\r\n                {\r\n                    foreach (var entry in entriesEl.EnumerateArray())\r\n                    {\r\n                        string shortcut = entry.TryGetProperty(\u0022shortcut\u0022, out var sEl) \u0026\u0026 sEl.ValueKind == JsonValueKind.String ? sEl.GetString() ?? \u0022\u0022 : \u0022\u0022;\r\n                        string description = entry.TryGetProperty(\u0022description\u0022, out var dEl) \u0026\u0026 dEl.ValueKind == JsonValueKind.String ? dEl.GetString() ?? \u0022\u0022 : \u0022\u0022;\r\n                        string pasteText = entry.TryGetProperty(\u0022paste_text\u0022, out var pEl) \u0026\u0026 pEl.ValueKind == JsonValueKind.String ? pEl.GetString() ?? \u0022\u0022 : \u0022\u0022;\r\n\r\n                        table.Rows.Add(shortcut, description, pasteText);\r\n                    }\r\n                }\r\n\r\n                grid.DataSource = table.DefaultView;\r\n\r\n                grid.CellDoubleClick \u002B= async (s, e) =\u003E\r\n                {\r\n                    if (e.RowIndex \u003E= 0 \u0026\u0026 e.RowIndex \u003C grid.Rows.Count)\r\n                 ",
    "firstAdded": "2025-10-12T15:44:39.8382824",
    "lastUsed": "2025-10-12T15:44:39.8382824",
    "uses": 1,
    "pinned": false
  }
]